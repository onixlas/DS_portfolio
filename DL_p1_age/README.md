# Задача

![](https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/Convolutional_Neural_Network_with_Color_Image_Filter.gif/640px-Convolutional_Neural_Network_with_Color_Image_Filter.gif 'Cecbur')

Задача: построить модель, которая по фотографии человека могла бы предсказывать его возраст. Для обучения будем использовать набор данных [APPA-REAL](https://chalearnlap.cvc.uab.es/dataset/26/description/).

# Выводы

Мы построили модель определения возраста по фотографии. Для обучения мы применили библиотеки pytorch и Lightning, нейросеть ResNet50, предобученную на наборе ImageNet.

В нашем распоряжении наборы фотографий, а также таблицы, в которых указан возраст человека на фотографии. Мы провели небольшое исследование данных. В учебной таблице содержатся записи о 4113 фотографиях. Средний возраст людей на них — 30 лет, медианный возраст — 28 лет. Есть фотографии людей с возрастом 1 год и 100 лет.

При выводе 10 случайных фотографий с людей с возрастами старше 90 лет и моложе 5 лет мы не обнаружили фотографий с некорректно размеченным возрастом.

Затем данные были подготовлены для обучения. Из всего набора файлов мы выделили файлы с лицами, загрузили их в класс DataSet, а затем передали его в класс DataLoader.

Для обучения была создана нейросеть ResNet50. Эта нейросеть обучалась для решения задачи классификации на наборе данных ImageNet. Чтобы адаптировать её под наши задачи мы заменили ей "голову" и функцию потерь. Затем "заморозили" основные слои нейронной сети и провели несколько эпох обучения.

В результате предварительного обучения средняя абсолютная ошибка на валидационных данных снизилась почти до семи лет, а на тестовых — до восьми.

Чтобы улучшить данный результат мы разморозили несколько последних слоёв сети ResNet и продолжили обучение.

Таким образом удалось снизить среднюю абсолютную ошибку на валидации почти до шести лет, а на тесте — до семи.

При этом на построенных графиках видно, что основной вклад в ошибку вносят фотографии людей старше 60 лет, так их мало в обучающем наборе данных. При получении дополнительных фотографий можно ожидать улучшения качества модели. 
